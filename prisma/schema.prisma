generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"] 
}

datasource db {
  provider = "postgresql"
  url      = env("DIRECT_URL")
  schemas  = ["public"] 
}

model Ibadah {
  id_ibadah       String       @id
  jenis_kebaktian String
  sesi_ibadah     Int
  tanggal_ibadah  DateTime
  weeklyEventId   String?
  weeklyEvent     WeeklyEvent? @relation(fields: [weeklyEventId], references: [id])
  Kehadiran       Kehadiran[]

  @@schema("public") 
}

model Kehadiran {
  id_kehadiran   String    @id
  id_ibadah      String
  id_jemaat      String
  waktu_presensi DateTime? @default(now()) @db.Timestamp(6)
  status         String?   @default("Hadir")
  name           String?
  ibadah         Ibadah    @relation(fields: [id_ibadah], references: [id_ibadah])
  jemaat         Jemaat    @relation(fields: [id_jemaat], references: [id_jemaat])

  @@schema("public")
}

model Jemaat {
  id_jemaat     String      @id
  name          String
  jabatan       String
  status        String
  tanggal_lahir DateTime
  gender        String
  email         String
  dateOfBirth   DateTime
  age           Int
  handphone     String
  kehadiran     Kehadiran[]

  @@schema("public")
}

model Statistics {
  stat_id String @id
  title   String
  text    String

  @@schema("public")
}

model User {
  id         String   @id 
  nama       String
  email      String   @unique
  isVerified String   @default("pending")
  role       String   @default("user")
  createdAt  DateTime @default(now())

  @@schema("public")
}

model WeeklyEvent {
  id              String    @id @default(cuid())
  sesi_ibadah     Int
  start_date      DateTime
  description     String?
  end_date        DateTime?
  jenis_kebaktian String
  repetition_type String    @default("Once")
  title           String
  Ibadah          Ibadah[]

  @@schema("public")
}