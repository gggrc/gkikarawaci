generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Ibadah {
  id_ibadah       String      @id
  jenis_kebaktian String     
  sesi_ibadah     Int
  tanggal_ibadah  DateTime
  Kehadiran       Kehadiran[]
  weeklyEventId   String?   
  weeklyEvent     WeeklyEvent? @relation(fields: [weeklyEventId], references: [id])
}

model Kehadiran {
  id_kehadiran   String    @id
  id_ibadah      String
  id_jemaat      String
  waktu_presensi DateTime? @default(now()) @db.Timestamp(6)
  status         String?   @default("Hadir")
  name           String?
  ibadah         Ibadah    @relation(fields: [id_ibadah], references: [id_ibadah])
  jemaat         Jemaat    @relation(fields: [id_jemaat], references: [id_jemaat])
}

model Jemaat {
  id_jemaat     String      @id
  name          String
  jabatan       String
  status        String
  tanggal_lahir DateTime
  gender        String
  email         String
  dateOfBirth   DateTime
  age           Int
  handphone     String
  kehadiran     Kehadiran[]
}

model Statistics {
  stat_id String @id
  title   String
  text    String
}

model User {
  user_id       Int       @id @default(autoincrement())
  clerkId       String    @unique
  nama          String
  email         String
  isVerified    String    @default("pending")
  role          String
}

model WeeklyEvent {
  id             String   @id @default(cuid())
  sesi_ibadah    Int     
  day_of_week    Int
  start_date     DateTime
  repeat_forever Boolean  @default(true)
  repeat_weeks   Int?
  created_at     DateTime @default(now())
  ibadahList     Ibadah[] 
  @@unique([sesi_ibadah, day_of_week])
}